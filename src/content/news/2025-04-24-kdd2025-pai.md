---
title: 北大KDD2025：无需插补！受Prompt Learning启发的稀疏电子病历数据分析协议
date: 2025-04-24
excerpt: 北京大学王亚沙教授、马连韬研究助理教授团队在数据挖掘领域顶级国际会议KDD 2025（计算机学会CCF-A类推荐）上发表了题为"Learnable Prompt as Pseudo-Imputation: Rethinking the Necessity of Traditional EHR Data Imputation in Downstream Clinical Prediction"的研究论文。
featured: true
tags: ['KDD2025', '电子病历', '缺失值处理', '深度学习', '机器学习']
category: research
image: /images/news/kdd2025-pai-header.jpg
---

北京大学王亚沙教授、马连韬研究助理教授团队在数据挖掘领域顶级国际会议KDD 2025（计算机学会CCF-A类推荐）上发表了题为"Learnable Prompt as Pseudo-Imputation: Rethinking the Necessity of Traditional EHR Data Imputation in Downstream Clinical Prediction"的研究论文。该研究针对电子健康记录(EHR)数据中普遍存在的"缺失值"问题，提出了一种无需传统插补方法的可学习提示伪插补方法（Learnable Prompt as Pseudo-Imputation, PAI），显著提升了各类临床预测任务的性能。

该研究由北京大学、教育部高可信软件技术重点实验室等机构联合完成，作者包括：廖伟斌、朱英豪、张中基、汪宇航、王子翔、初旭、王亚沙、马连韬。

## 研究背景：传统EHR缺失值处理的困境

基于电子健康记录(EHR)分析患者健康状况是医学信息学的基础研究问题。然而，EHR数据中普遍存在大量缺失值，使得深度神经网络(DNNs)难以直接建模患者健康状态。

传统的深度学习训练协议通常包含两个模块：一个是面向缺失值的插补模块，一个是面向插补后的临床任务预测模块。现有的研究使用如下两种方式来完成临床预测任务：

### 传统方法的局限性

1. **"先插补后预测"训练协议**：将插补作为临床预测的预处理步骤，使用均值替换、回归、统计方法等技术填充缺失值。然而，这种方法引入了非真实数据到下游临床预测任务中，导致模型性能下降和偏差估计。

2. **"插补与预测联合优化"训练协议**：将插补模型和预测模型耦合在一起，在同一训练过程中进行联合优化。虽然效果较好，但该方法要求更复杂的优化空间和大量完整EHR数据（在现实中难以获得）。

### 关键发现

研究团队发现，在插补任务上选择插补性能最佳的模型（如SAITS），插补后的数据却不能获得最佳临床预测性能（插补性能不是最佳的TimesNet在后续的预测任务中性能最佳）。这表明插补模型观察到的缺失值条件期望可能不是预测任务的最佳目标，启发团队无需建模一个在插补任务上性能最优的方法，而应该提出最适用于下游预测任务的伪插补方法。

![传统方法 vs PAI方法对比](https://mmbiz.qpic.cn/mmbiz_png/dyabGzHWib7ibgkxibVpcZ42lcLANKfU5NibiaNiaBic38qmUX2p03WdoY697x8T8k0kpQc8UHUzJvbIs8zekrorgJ99Q/640?wx_fmt=png&from=appmsg&wxfrom=13&tp=wxpic#imgIndex=0)

## 创新方法：可学习提示伪插补（PAI）

最近，自然语言处理（NLP）和计算机视觉（CV）领域中，为了更好的提示大模型完成任务，prompt learning提出不再使用手工撰写的prompt，而是使用一个可学习的向量，来指导的特定任务。受到该启发，研究团队思考是否可以不再手工/额外的插补模块来查补充缺失值，而是使用提示向量直接端到端的学习临床预测任务？

为此，研究团队提出了可学习提示伪插补（PAI）方法，不再依赖传统插补模型，而是通过"可学习提示"（learnable prompt）直接从下游预测任务学习优化方向。

### 核心突破

1. **可学习特征提示**：PAI引入可学习的提示向量，取代传统插补值，为不同特征的缺失位置插入不同提示。

2. **任务导向优化**：PAI在训练过程中基于下游任务的损失更新提示向量，使DNNs能够直接基于真实数据学习，无需依赖手动或自动数据插补。

3. **异步学习策略**：考虑到模型结构与提示向量的异质性，PAI采用异步学习策略，为backbone模型和提示向量分配不同的学习率，帮助DNNs更好地建模缺失值。

4. **即插即用特性**：作为一种即插即用方法，PAI可以无缝集成到任何现有DNNs分析框架中，不需要修改骨干模型结构，仅增加极少量参数（约2%）。

![PAI方法示意图](data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg width='1px' height='1px' viewBox='0 0 1 1' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/2000/svg'%3E%3Ctitle%3E%3C/title%3E%3Cg stroke='none' stroke-width='1' fill='none' fill-rule='evenodd' fill-opacity='0'%3E%3Cg transform='translate(-249.000000, -126.000000)' fill='%23FFFFFF'%3E%3Crect x='249' y='126' width='1' height='1'%3E%3C/rect%3E%3C/g%3E%3C/g%3E%3C/svg%3E)

## 实验结果：全面超越传统方法

研究团队在4个真实世界数据集（MIMIC-IV、CDSL、Sepsis和eICU）、8种EHR分析模型（RNN、LSTM、GRU、Transformer、RETAIN、ConCare、M3Care、SAFARI）和2类临床预测任务（分类、回归）上评估了PAI方法的有效性。

### 1. 全面对比常用的"先插补后预测"训练协议

在死亡预测任务（分类）和住院时长预测任务（回归）两个任务上，PAI在4个数据集、8个EHR分析模型、3个指标上全面超越了传统的静态插补策略，包括LOCF和Zero插补。

### 2. 对比"先插补后预测"训练协议中更先进的基线模型

PAI在与更先进的插补方法的对比中也表现出显著优势，证明了其方法的有效性。

### 3. 对比"插补与预测联合优化"训练协议中的基线模型

即使与联合优化的复杂方法相比，PAI仍然能够取得更好的性能，同时大大简化了训练流程。

### 4. 异步学习率有效性验证

实验证明了可学习向量的学习率应使用比骨干模型更小的学习率，可以得到更优的性能。

### 5. PAI的有效性分析

**a) PAI的有效性是否来自于更多的参数？**
试验结果表明传统 "先插补后预测"训练协议即使使用更多的训练参数也难以达到PAI的性能，此外，PAI仅引入了2%的参数量。这表明PAI的性能提升并不是来自于更多的参数量。

**b) PAI的有效性是否来自于对缺失模式的学习？**
实验表明即使EHR的数据缺失模式确实变得随机化，PAI仍然能够得到显著的性能提升，证明了方法的鲁棒性。

## 总结展望

该研究通过提出PAI方法，重新思考了传统EHR缺失值插补的必要性，为提升临床预测任务性能提供了一种轻量化、高效的解决方案。PAI直接从下游任务标签信息学习，无需复杂的插补模型，表现出更强的性能优势和鲁棒性。

作为一种简单但高度可扩展的方法，PAI可以完美兼容各种EHR分析任务，且不引入偏差。未来研究团队将持续探索PAI在更多临床场景中的应用潜力，包括拓展到多模态医疗数据分析和个性化医疗等领域。

## 研究链接

- **研究发布链接**：https://dl.acm.org/doi/abs/10.1145/3690624.3709166
- **代码开源**：https://github.com/MrBlankness/PAI

---

*医维矩阵实验室*
*2025年4月24日*